!function($){"use strict";$.fn.get_oembed=function(e,t){var o=$(this),n=o.next(".oembed_code");if(n[0]){var i=n.html();n.remove();var a={action:"get_oembed",onlycode:t,urlOembed:escape(i),dataType:"json"};$.post(SiteParameters.admin_ajax,a,function(n){if(""!=n)try{var i=JSON.parse(n);if("null"==i.code?(o.html("<b>oEmbed not supported.</b>"),o.closest(".uploader-uncode-media").find(".spinner").removeClass("visible")):o.html(i.code),e&&t){var a,s,r;a=i.mime,"image/url"==i.mime?$(i.code).on("load",function(t){s=$(t.target)[0].width,r=$(t.target)[0].height,e(a,s,r)}):(s=i.width,r=i.height,e(a,s,r))}}catch(d){o.closest(".uploader-uncode-media").find(".spinner").removeClass("visible")}})}},$(document).on("ready",function(){$(document).on("DOMNodeInserted",function(e){try{($(e.target).closest(".media-modal").length||$(e.target).closest(".wpb_el_type_media_element").length||$(e.target).closest(".attachments").length)&&($(e.target).is(".attachment")&&$(e.target).find(".oembed").length>0&&$(e.target).find(".oembed:not(.rendered)").get_oembed(null,!0),$(e.target).find(".attachment-media-view").length>0&&$(e.target).find(".oembed").length>0&&$(e.target).find(".oembed:not(.rendered)").get_oembed(null,!0),$(e.target).is(".format-settings")&&$.each($(".oembed:not(.rendered)",e.target),function(e,t){$(this).get_oembed(null,!0)}))}catch(e){}})}),$(".vc_welcome-header").html("Welcome to Uncode<br>Visual Composer Version"),$("a.deactivate-jscomposer").on("click",function(e){e.preventDefault(),$.ajax({type:"post",dataType:"json",data:{action:"deactivate_js_composer"},url:ajaxurl,success:function(e){1==e&&($("a.deactivate-jscomposer").addClass("button-disabled"),window.location="admin.php?page=uncode-plugins")}})})}(jQuery),function($){function e(){this.isField=!0,this.down=!1,this.inFocus=!1,this.disabled=!1,this.cutOff=!1,this.hasLabel=!1,this.keyboardMode=!1,this.nativeTouch=!0,this.wrapperClass="colors-dropdown",this.onChange=null}e.prototype={constructor:e,instances:{},init:function(e,t){var o=this;$.extend(o,t),o.$select=$(e),o.id=e.id,o.options=[],o.$options=o.$select.find("option"),o.isTouch="ontouchstart"in window||navigator.maxTouchPoints,o.$select.removeClass(o.wrapperClass+" dropdown"),o.$select.is(":disabled")&&(o.disabled=!0),o.$options.length&&(o.$options.each(function(e){var t=$(this);t.is(":selected")&&(o.selected={index:e,title:t.text(),color:t.attr("class")},o.focusIndex=e),t.hasClass("label")&&0==e?(o.hasLabel=!0,o.label=t.text(),t.attr("value","")):o.options.push({domNode:t[0],title:t.text(),value:t.val(),color:t.attr("class"),disabled:t.is(":disabled"),selected:t.is(":selected")})}),o.selected||(o.selected={index:0,title:o.$options.eq(0).text()},o.focusIndex=0),o.render())},render:function(){var e=this,t=e.isTouch&&e.nativeTouch?" touch":"",o=e.disabled?" disabled":"";e.$container=e.$select.wrap('<div class="'+e.wrapperClass+t+o+'"><span class="old"/></div>').parent().parent(),e.$active=$('<span class="selected">'+e.selected.title+(""!=e.selected.color?" <small>: "+e.selected.color+" </small>":"")+'<span class="color style-'+e.selected.color+'-bg"></span></span>').appendTo(e.$container),e.$carat=$('<span class="carat"/>').appendTo(e.$container),e.$scrollWrapper=$('<div class="dropdown-colors-list"><ul/></div>').appendTo(e.$container),e.$dropDown=e.$scrollWrapper.find("ul"),e.$form=e.$container.closest("form"),$.each(e.options,function(){var t=this,o=t.disabled?" disabled":"",n=t.selected?" active":"",i="";(""!=o||""!=n)&&(i=' class="'+o+n+'"'),e.$dropDown.append("<li"+i+">"+t.title+(""!=t.color?" <small>: "+t.color+" </small>":"")+'<span class="color style-'+t.color+'-bg"></span></li>')}),e.$items=e.$dropDown.find("li"),e.cutOff&&e.$items.length>e.cutOff&&e.$container.addClass("scrollable"),e.getMaxHeight(),e.isTouch&&e.nativeTouch?e.bindTouchHandlers():e.bindHandlers()},getMaxHeight:function(){var e=this;for(e.maxHeight=0,i=0;i<e.$items.length;i++){var t=e.$items.eq(i);if(e.maxHeight+=t.outerHeight(),e.cutOff==i+1)break}},bindTouchHandlers:function(){var e=this;e.$container.on("click.easyDropDown",function(){e.$select.focus()}),e.$select.on({change:function(){var t=$(this).find("option:selected"),o=t.text(),n=t.val();e.$active.text(o),"function"==typeof e.onChange&&e.onChange.call(e.$select[0],{title:o,value:n})},focus:function(){e.$container.addClass("focus")},blur:function(){e.$container.removeClass("focus")}})},bindHandlers:function(){var e=this;e.query="",e.$container.on({"click.easyDropDown":function(){e.down||e.disabled?e.close():e.open()},"mousemove.easyDropDown":function(){e.keyboardMode&&(e.keyboardMode=!1)}}),$("body").on("click.easyDropDown."+e.id,function(t){var o=$(t.target),n=e.wrapperClass.split(" ").join(".");!o.closest("."+n).length&&e.down&&e.close()}),e.$items.on({"click.easyDropDown":function(){var t=$(this).index();e.select(t),e.$select.focus()},"mouseover.easyDropDown":function(){if(!e.keyboardMode){var t=$(this);t.addClass("focus").siblings().removeClass("focus"),e.focusIndex=t.index()}},"mouseout.easyDropDown":function(){e.keyboardMode||$(this).removeClass("focus")}}),e.$select.on({"focus.easyDropDown":function(){e.$container.addClass("focus"),e.inFocus=!0},"blur.easyDropDown":function(){e.$container.removeClass("focus"),e.inFocus=!1},"keydown.easyDropDown":function(t){if(e.inFocus){e.keyboardMode=!0;var o=t.keyCode;if((38==o||40==o||32==o)&&(t.preventDefault(),38==o?(e.focusIndex--,$(e.$items[e.focusIndex]).hasClass("disabled")&&e.focusIndex--,e.focusIndex=e.focusIndex<0?0:e.focusIndex):40==o&&(e.focusIndex++,$(e.$items[e.focusIndex]).hasClass("disabled")&&e.focusIndex++,e.focusIndex=e.focusIndex>e.$items.length-1?e.$items.length-1:e.focusIndex),e.down||e.open(),e.$items.removeClass("focus").eq(e.focusIndex).addClass("focus"),e.cutOff&&e.scrollToView(),e.query=""),e.down)if(9==o||27==o)e.close();else{if(13==o)return t.preventDefault(),e.select(e.focusIndex),e.close(),!1;if(8==o)return t.preventDefault(),e.query=e.query.slice(0,-1),e.search(),clearTimeout(e.resetQuery),!1;if(38!=o&&40!=o){var n=String.fromCharCode(o);e.query+=n,e.search(),clearTimeout(e.resetQuery)}}}},"keyup.easyDropDown":function(){e.resetQuery=setTimeout(function(){e.query=""},1200)}}),e.$dropDown.on("scroll.easyDropDown",function(t){e.$dropDown[0].scrollTop>=e.$dropDown[0].scrollHeight-e.maxHeight?e.$container.addClass("bottom"):e.$container.removeClass("bottom")}),e.$form.length&&e.$form.on("reset.easyDropDown",function(){var t=e.hasLabel?e.label:e.options[0].title;e.$active.text(t)})},unbindHandlers:function(){var e=this;e.$container.add(e.$select).add(e.$items).add(e.$form).add(e.$dropDown).off(".easyDropDown"),$("body").off("."+e.id)},open:function(){var e=this,t=window.scrollY||document.documentElement.scrollTop,o=window.scrollX||document.documentElement.scrollLeft,n=e.notInViewport(t);e.closeAll(),e.getMaxHeight(),e.$select.focus(),e.$container.addClass("open"),e.$scrollWrapper.css("height",e.maxHeight+"px"),e.down=!0},close:function(){var e=this;e.$container.removeClass("open"),e.$scrollWrapper.css("height","0px"),e.focusIndex=e.selected.index,e.query="",e.down=!1},closeAll:function(){var e=this,t=Object.getPrototypeOf(e).instances;for(var o in t){var n=t[o];n.close()}},select:function(e){var t=this;"string"==typeof e&&(e=t.$select.find("option[value="+e+"]").index()-1);var o=t.options[e],n=t.hasLabel?e+1:e;t.$items.removeClass("active").eq(e).addClass("active"),t.$active.html(o.title+(""!=o.color?" <small>: "+o.color+" </small>":"")+'<span class="color style-'+o.color+'-bg"></span>'),t.$select.find("option").removeAttr("selected").eq(n).prop("selected",!0).parent().trigger("change"),t.selected={index:e,title:o.title},t.focusIndex=i,"function"==typeof t.onChange&&t.onChange.call(t.$select[0],{title:o.title,value:o.value})},search:function(){var e=this,t=function(t){e.focusIndex=t,e.$items.removeClass("focus").eq(e.focusIndex).addClass("focus"),e.scrollToView()},o=function(t){return e.options[t].title.toUpperCase()};for(i=0;i<e.options.length;i++){var n=o(i);if(0==n.indexOf(e.query))return void t(i)}for(i=0;i<e.options.length;i++){var n=o(i);if(n.indexOf(e.query)>-1){t(i);break}}},scrollToView:function(){var e=this;if(e.focusIndex>=e.cutOff){var t=e.$items.eq(e.focusIndex),o=t.outerHeight()*(e.focusIndex+1)-e.maxHeight;e.$dropDown.scrollTop(o)}},notInViewport:function(e){var t=this,o={min:e,max:e+(window.innerHeight||document.documentElement.clientHeight)},n=t.$dropDown.offset().top+t.maxHeight;return n>=o.min&&n<=o.max?0:n-o.max+5},destroy:function(){var e=this;e.unbindHandlers(),e.$select.unwrap().siblings().remove(),e.$select.unwrap(),delete Object.getPrototypeOf(e).instances[e.$select[0].id]},disable:function(){var e=this;e.disabled=!0,e.$container.addClass("disabled"),e.$select.attr("disabled",!0),e.down||e.close()},enable:function(){var e=this;e.disabled=!1,e.$container.removeClass("disabled"),e.$select.attr("disabled",!1)}};var t=function(t,n){t.id=t.id?t.id:"EasyDropDown"+o();var i=new e;i.instances[t.id]||(i.instances[t.id]=i,i.init(t,n))},o=function(){return("00000"+(16777216*Math.random()<<0).toString(16)).substr(-6).toUpperCase()};$.fn.easyDropDown=function(){var o=arguments,n=[],i;return i=this.each(function(){if(o&&"string"==typeof o[0]){var i=e.prototype.instances[this.id][o[0]](o[1],o[2]);i&&n.push(i)}else t(this,o[0])}),n.length?n.length>1?n:n[0]:i},$(function(){"function"!=typeof Object.getPrototypeOf&&("object"==typeof"test".__proto__?Object.getPrototypeOf=function(e){return e.__proto__}:Object.getPrototypeOf=function(e){return e.constructor.prototype}),$("select.dropdown").each(function(){var e=$(this).attr("data-settings");settings=e?$.parseJSON(e):{},t(this,settings)})}),$.fn.uncode_init_upload=function(){$(document).on("click",".ot_upload_media",function(e){e.preventDefault();var t={},o="uncode-editor",n=wp.media.view.AttachmentsBrowser,i=wp.media,a=$(this).parent(".option-tree-ui-upload-parent").find("input").attr("id"),s=$(this).attr("rel"),r=$("#"+a).val(),d="";return t[o]?void t[o].open():(i.view.uploadMediaView=i.View.extend({tagName:"div",className:"uploader-uncode-media",template:i.template("uploader-uncode-media"),events:{"click .close":"hide","paste #mle-code":"entercode","input #mle-code":"entercode"},oembed_callback:function(e,t,o){var n=void 0!=window.workflow?workflow:wp.media.frame,i=n.$el;$button=i.find(".media-button"),$spinner=i.find(".spinner"),""!=e&&(i.find("#mle-mime").val(e),i.find("#mle-width").val(t),i.find("#mle-height").val(o),$button.removeAttr("disabled"),$spinner.removeClass("visible"))},entercode:function(e){var t=this,o=$(this.$el),n=o.find("#mle-code"),i=o.find(".oembed_code"),a=o.find(".oembed"),s=o.find(".spinner"),r;setTimeout(function(){r=n.val(),0==i.length?a.after('<div class="oembed_code">'+r+"</div>"):i.html(r),a.get_oembed(t.oembed_callback,!0),s.addClass("visible")},100)},recordmedia:function(){var e=this,n=$(this.$el),i=t[o].$el.find(".media-button-select");"uploader-uncode-media"==t[o].content.get().el.className?(i.attr("disabled","disabled"),$.ajax({type:"POST",dataType:"json",url:ajaxurl+"?action=recordMedia",data:n.find("input[name],select[name],textarea[name]").serialize(),success:function(e){isNaN(e.id)||void 0==e||(d+='<div class="option-tree-ui-image-wrap"><div class="oembed"><span class="spinner" style="display: block; float: left;"></span></div><div class="oembed_code" style="display: none;">'+e.url+"</div></div>",$("#"+a).val(e.id),$("#"+a+"_media").remove(),$("#"+a).parent().parent("div").append('<div class="option-tree-ui-media-wrap" id="'+a+'_media" />'),$("#"+a+"_media").append(d).slideDown(),$("#"+a+"_media .oembed").get_oembed(null,!0),$("#"+a+"_media .spinner").removeClass("visible"),i.removeAttr("disabled"),t[o].off("select"),t[o].close())}})):e.select()},ready:function(){var e=this,n=t[o].$el.find(".media-button-select");n.off("click").on("click",function(){e.recordmedia()})},select:function(){var e=i.frame.toolbar.get("selection").selection.single();i.frame.close()}}),t[o]=i({title:$(this).attr("title"),button:{text:option_tree.upload_text},multiple:!1}),t[o].on("router:render:browse",function(e){e.set({upload:{text:"Upload Files",priority:20},browse:{text:"Media Library",priority:40},uncode:{text:"Upload oEmbed",priority:30}})}),t[o].on("content:render:uncode",function(){t[o].content.set(new i.view.uploadMediaView({controller:this}))}),t[o].on("close",function(){wp.media.view.AttachmentsBrowser=n}),t[o].on("select",function(){var e=t[o].state().get("selection").first(),n=e.attributes.url,i=e.attributes.id,s=e.attributes.mime,r=/^image\/(?:jpe?g|png|url|gif|x-icon)$/i;d+="oembed/svg"==s?'<div class="option-tree-ui-image-wrap">'+e.attributes.description+"</div>":s.match(r)?'<div class="option-tree-ui-image-wrap"><img src="'+n+'" alt="" /></div>':'<div class="option-tree-ui-image-wrap"><div class="oembed"><span class="spinner" style="display: block; float: left;"></span></div><div class="oembed_code" style="display: none;">'+n+"</div></div>",d+='<a href="#" class="option-tree-ui-remove-media option-tree-ui-button button button-secondary light" title="'+option_tree.remove_media_text+'"><span class="icon fa fa-minus2"></span>'+option_tree.remove_media_text+"</a>",$("#"+a).val(i),$("#"+a+"_media").remove(),$("#"+a).parent().parent("div").append('<div class="option-tree-ui-media-wrap" id="'+a+'_media" />'),$("#"+a+"_media").append(d).slideDown(),$("#"+a+"_media .oembed").get_oembed(),t[o].off("select"),t[o].close()}),t[o].on("open",function(){var e=t[o].state().get("selection"),n=i.attachment(r);n.fetch(),e.set(n)}),void t[o].open())}),$(document).on("click",".option-tree-ui-remove-media",function(e){e.preventDefault();var t=$(e.currentTarget).closest("td"),o=t.find(".option-tree-ui-upload-parent input"),n=t.find(".option-tree-ui-media-wrap");o.attr("value",""),n.remove()})};var n=wp.media;n&&null!=mediaTaxonomies&&$.each(mediaTaxonomies,function(e,t){n.view.AttachmentFilters[e]=n.view.AttachmentFilters.extend({className:"attachment-filters",createFilters:function(){var t={};_.each(mediaTerms[e]||{},function(o){var n={};n[e]={taxonomy:e,term_id:parseInt(o.id,10),term_slug:o.slug},t[o.slug]={text:o.label,props:n}}),this.filters=t}});var o=n.view.AttachmentsBrowser;n.view.AttachmentsBrowser=n.view.AttachmentsBrowser.extend({createToolbar:function(){n.model.Query.defaultArgs.filterSource="filter-media-taxonomies",o.prototype.createToolbar.apply(this,arguments),this.toolbar.set(e,new n.view.AttachmentFilters[e]({controller:this.controller,model:this.collection.props,priority:-80}).render())}})}),$("html").delegate(".media-terms input","change",function(){var e=$(this),t=e.parents(".media-terms"),o=t.parent(),n={action:"save-media-terms",term_ids:[],attachment_id:t.data("id"),taxonomy:t.data("taxonomy")};t.find("input:checked").each(function(){n.term_ids.push($(this).val())}),o.addClass("media-save-terms"),t.find("input").prop("disabled","disabled"),$.post(ajaxurl,n,function(e){o.removeClass("media-save-terms"),t.find("input").removeProp("disabled")})}),$("html").delegate(".toggle-add-media-term","click",function(e){e.preventDefault(),$(this).parent().find(".add-new-term").toggle()}),$("html").delegate(".save-media-category","click",function(e){var t=$(this),o=t.parent().find("input"),n=t.parent().find("select"),i={action:"add-media-term",attachment_id:t.data("id"),taxonomy:t.data("taxonomy"),parent:n.val(),term:o.val()};return""==i.term?void o.focus():void $.post(ajaxurl,i,function(e){t.parents(".field").find(".media-terms ul:first").html(e.checkboxes),t.parents(".field").find("select").replaceWith(e.selectbox),o.val("")},"json")})}(jQuery),function($){"use strict";var e=window.UNCODE||{};e.dismissAdminNotices=function(){$("#uncode_vc_admin_notice").on("click",".notice-dismiss",function(){$.ajax({url:ajaxurl,data:{action:"uncode_vc_admin_notice_dismiss"}})})},$(function(){e.dismissAdminNotices()})}(jQuery);